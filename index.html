<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ApexTV</title>
    <link rel="icon" href="Apex.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">

    <!-- Rubik Bold -->
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Background Video -->
    <video autoplay muted loop id="bg-video">
        <source src="background.mp4" type="video/mp4">
    </video>

    <!-- Discord Button -->
    <a href="https://discord.gg/5a9pxtmVCC" target="_blank" id="discord-btn">
        <img src="images/discord-white-icon.webp" alt="Discord">
    </a>

    <!-- VRFS Champions Button (image) -->
    <a href="https://www.roblox.com/games/133603832850212/VRFS-Champions" target="_blank" id="vrfs-btn">
        <img src="images/Banner2.png" alt="VRFS Champions">
    </a>

    <div class="container">
        <h1>ApexTV</h1>

        <div id="announcements"></div>
        <div id="games"></div>
    </div>

    <script>
        // CSV URLs
        const gamesURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRkv0zHUdhN-y48FkCmTeKwq6j-ZzOnvu0QPxZP4qeapyw0OfTY4jHZFpsLHD3zDWzDAcCkZKe8AY2K/pub?output=csv";
        const announcementsURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVEKnXC_xcQSK3-w-1khtOJQ4j0rbEsjdKtbqdjcJA5bs5_WTjTSTpQxkiCVg06a-c-1E0oTduvb16/pub?output=csv";

        // Convert CSV â†’ array
        function parseCSV(text) {
            return text.split("\n").slice(1).map(row => {
                const cols = row.split(",");
                return {
                    Title: cols[0],
                    Thumbnail: cols[1],
                    Link: cols[2],
                    Date: cols[3]
                };
            });
        }

        // Load games
        fetch(gamesURL)
            .then(r => r.text())
            .then(data => {
                const games = parseCSV(data);
                const gamesDiv = document.getElementById("games");

                games.forEach(g => {
                    if (!g.Title) return;

                    // Only show if date is valid OR no date
                    if (g.Date) {
                        const gameDate = new Date(g.Date);
                        const now = new Date();
                        if (now > gameDate) return;
                    }

                    const tab = document.createElement("a");
                    tab.href = g.Link;
                    tab.className = "game-tab";
                    tab.target = "_blank";

                    tab.innerHTML = `
                        <img src="${g.Thumbnail}" class="thumb">
                        <div class="game-title">${g.Title}</div>
                    `;

                    gamesDiv.appendChild(tab);
                });
            });

        // Load announcements
        fetch(announcementsURL)
            .then(r => r.text())
            .then(data => {
                const ann = parseCSV(data);
                const box = document.getElementById("announcements");

                ann.forEach(a => {
                    if (!a.Title) return;

                    const item = document.createElement("div");
                    item.className = "announce-item";
                    item.textContent = a.Title;

                    box.appendChild(item);
                });
            });

    </script>

</body>
</html>


